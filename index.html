<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Space Survivor</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

<style>
*{margin:0;padding:0;box-sizing:border-box;font-family:Arial}
html,body{
  background:#000;color:#fff;overflow:hidden;
  touch-action:none;
  overscroll-behavior:none;
}
canvas{
  display:block;margin:auto;
  background:radial-gradient(circle at bottom,#020617,#000);
  border-radius:16px;
}

/* HUD */
.hud{
  position:absolute;top:10px;width:100%;
  display:flex;justify-content:center;gap:10px;z-index:5
}
.hud span{
  background:rgba(0,0,0,.6);
  padding:6px 14px;border-radius:999px;font-size:14px
}

/* OVERLAY */
.overlay{
  position:absolute;inset:0;
  display:none;
  align-items:center;justify-content:center;
  background:rgba(0,0,0,.85);
  z-index:10;
}
.menu{
  background:#020617;
  border-radius:20px;
  padding:26px;
  width:300px;
  text-align:center;
  box-shadow:0 0 40px rgba(56,189,248,.4);
  animation:menuIn .4s ease;
}
@keyframes menuIn{
  from{transform:translateY(40px);opacity:0}
  to{transform:translateY(0);opacity:1}
}
.menu h1{margin-bottom:10px;color:#38bdf8}
.menu button,input{
  width:100%;margin:6px 0;padding:12px;
  border:none;border-radius:999px;font-weight:bold
}
.menu button{
  cursor:pointer;background:#38bdf8;color:#020617;
  transition:.2s
}
.menu button:hover{transform:scale(1.05)}
.menu input{text-align:center}

/* INTRO */
#intro{
  position:absolute;inset:0;
  background:#020617;
  display:flex;align-items:center;justify-content:center;
  flex-direction:column;
  z-index:20;
}
#rocket{
  width:40px;height:60px;
  background:#38bdf8;
  clip-path:polygon(50% 0,100% 100%,50% 85%,0 100%);
  animation:fly 2s infinite ease-in-out;
}
@keyframes fly{
  0%{transform:translateY(20px)}
  50%{transform:translateY(-20px)}
  100%{transform:translateY(20px)}
}
#intro h1{margin-top:20px;color:#38bdf8}

/* MOBILE */
#shootBtn,#pauseBtn{
  position:absolute;width:80px;height:80px;
  border-radius:50%;border:none;font-weight:bold;
  display:none;z-index:6
}
#shootBtn{right:20px;bottom:20px;background:#ef4444;color:#fff}
#pauseBtn{left:20px;top:20px;background:#38bdf8;color:#000}

/* JOYSTICK */
#joystick{
  position:absolute;bottom:20px;left:20px;
  width:120px;height:120px;
  border-radius:50%;
  background:rgba(255,255,255,.08);
  display:none;z-index:6
}
#stick{
  width:50px;height:50px;border-radius:50%;
  background:#38bdf8;
  position:absolute;left:35px;top:35px
}
</style>
</head>

<body>

<div id="intro">
  <div id="rocket"></div>
  <h1>SPACE SURVIVOR</h1>
  <p>Toque para começar</p>
</div>

<div class="hud" id="hud">
  <span id="hudScore">Score: 0</span>
  <span id="hudCoins">Moedas: 0</span>
</div>

<div id="overlay" class="overlay"></div>

<canvas id="game" width="400" height="600"></canvas>

<button id="shootBtn">ATIRAR</button>
<button id="pauseBtn">PAUSE</button>
<div id="joystick"><div id="stick"></div></div>

<script>
/* ================= SAVE ================= */
const save=JSON.parse(localStorage.getItem("spaceSave")||"{}");
save.coins??=0;
save.skin??="#38bdf8";
save.name??="Jogador";
save.options??={hud:true};
save.upgrades??={double:false,fast:false};
localStorage.setItem("spaceSave",JSON.stringify(save));

/* ================= STATE ================= */
const STATE={MENU:0,PLAY:1,PAUSE:2};
let gameState=STATE.MENU;

/* ================= CANVAS ================= */
const canvas=document.getElementById("game");
const ctx=canvas.getContext("2d");

/* ================= STARS ================= */
let stars=[...Array(120)].map(()=>({x:Math.random()*400,y:Math.random()*600,s:Math.random()*2+1}));

/* ================= PLAYER ================= */
const player={x:200,y:500,r:14,speed:4,skin:save.skin};

/* ================= GAME ================= */
let bullets=[],enemies=[],explosions=[];
let score=0,coins=save.coins,cooldown=0;

/* ================= INPUT ================= */
const input={x:0,y:0,shoot:false};

/* ================= INTRO ================= */
intro.onclick=()=>{
  intro.remove();
  mainMenu();
};

/* ================= MENUS ================= */
const overlay=document.getElementById("overlay");
function showMenu(html){overlay.innerHTML=html;overlay.style.display="flex";}
function hideMenu(){overlay.style.display="none";}

function mainMenu(){
showMenu(`
<div class="menu">
<h1>SPACE SURVIVOR</h1>
<input value="${save.name}" oninput="save.name=this.value;saveGame()">
<button onclick="startGame()">JOGAR</button>
<button onclick="shopMenu()">SKINS</button>
<button onclick="optionsMenu()">OPÇÕES</button>
<button onclick="creditsMenu()">CRÉDITOS</button>
</div>`);
}

function shopMenu(){
showMenu(`
<div class="menu">
<h1>SKINS</h1>
<button onclick="setSkin('#38bdf8')">AZUL</button>
<button onclick="setSkin('#22c55e')">VERDE</button>
<button onclick="setSkin('#facc15')">AMARELO</button>
<button onclick="mainMenu()">VOLTAR</button>
</div>`);
}
function setSkin(c){player.skin=c;save.skin=c;saveGame();}

function optionsMenu(){
showMenu(`
<div class="menu">
<h1>OPÇÕES</h1>
<button onclick="toggleHUD()">HUD: ${save.options.hud?'ON':'OFF'}</button>
<button onclick="mainMenu()">VOLTAR</button>
</div>`);
}
function toggleHUD(){
save.options.hud=!save.options.hud;
hud.style.display=save.options.hud?'flex':'none';
saveGame();optionsMenu();
}

function creditsMenu(){
showMenu(`
<div class="menu">
<h1>CRÉDITOS</h1>
<p>Feito com ❤️</p>
<button onclick="mainMenu()">VOLTAR</button>
</div>`);
}

/* ================= START ================= */
function startGame(){
  bullets=[];enemies=[];explosions=[];
  score=0;coins=save.coins;
  gameState=STATE.PLAY;
  hideMenu();
  shootBtn.style.display=pauseBtn.style.display=joystick.style.display="block";
}

/* ================= SAVE ================= */
function saveGame(){
save.coins=coins;
localStorage.setItem("spaceSave",JSON.stringify(save));
}

/* ================= CONTROLS ================= */
shootBtn.ontouchstart=e=>{e.preventDefault();input.shoot=true}
shootBtn.ontouchend=e=>{e.preventDefault();input.shoot=false}

joystick.ontouchmove=e=>{
const r=joystick.getBoundingClientRect();
const t=e.touches[0];
input.x=(t.clientX-(r.left+r.width/2))/30;
input.y=(t.clientY-(r.top+r.height/2))/30;
};
joystick.ontouchend=()=>input.x=input.y=0;

pauseBtn.onclick=()=>{
  if(gameState===STATE.PLAY){
    gameState=STATE.PAUSE;
    showMenu(`
    <div class="menu">
    <h1>PAUSE</h1>
    <button onclick="resume()">CONTINUAR</button>
    <button onclick="mainMenu()">MENU</button>
    </div>`);
  }
};
function resume(){hideMenu();gameState=STATE.PLAY;}

/* ================= UPDATE ================= */
function update(){
if(gameState!==STATE.PLAY)return;

player.x+=input.x*player.speed;
player.y+=input.y*player.speed;

if(input.shoot && cooldown<=0){
cooldown=save.upgrades.fast?6:12;
bullets.push({x:player.x,y:player.y});
if(save.upgrades.double){
bullets.push({x:player.x-6,y:player.y});
bullets.push({x:player.x+6,y:player.y});
}
}
cooldown--;

if(Math.random()<0.03) enemies.push({x:Math.random()*360+20,y:-20,r:14});

bullets.forEach(b=>b.y-=8);
enemies.forEach(e=>e.y+=2);

enemies.forEach((e,ei)=>{
bullets.forEach((b,bi)=>{
if(Math.hypot(e.x-b.x,e.y-b.y)<e.r){
enemies.splice(ei,1);
bullets.splice(bi,1);
explosions.push({x:e.x,y:e.y,t:20});
score+=10;coins++;
}
});
});

hudScore.textContent="Score: "+score;
hudCoins.textContent="Moedas: "+coins;
saveGame();
}

/* ================= DRAW ================= */
function draw(){
ctx.clearRect(0,0,400,600);

/* STARS */
ctx.fillStyle="#888";
stars.forEach(s=>{
s.y+=s.s*.3;if(s.y>600)s.y=0;
ctx.fillRect(s.x,s.y,2,2);
});

/* PLAYER */
ctx.fillStyle=player.skin;
ctx.beginPath();ctx.arc(player.x,player.y,player.r,0,7);ctx.fill();

/* BULLETS */
ctx.fillStyle="#fff";
bullets.forEach(b=>ctx.fillRect(b.x-2,b.y,4,10));

/* ENEMIES */
ctx.fillStyle="#ef4444";
enemies.forEach(e=>{
ctx.beginPath();ctx.arc(e.x,e.y,e.r,0,7);ctx.fill();
});

/* EXPLOSIONS */
explosions.forEach(ex=>{
ctx.strokeStyle=`rgba(255,255,255,${ex.t/20})`;
ctx.beginPath();ctx.arc(ex.x,ex.y,20-ex.t,0,7);ctx.stroke();
});
}

/* ================= LOOP ================= */
(function loop(){update();draw();requestAnimationFrame(loop)})();
</script>
</body>
</html>