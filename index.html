<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Space Survivor</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">

<!-- NOVA FONTE HUD -->
<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&display=swap" rel="stylesheet">

<style>
*{margin:0;padding:0;box-sizing:border-box}
html,body{background:#000;color:#fff;overflow:hidden;font-family:Arial}
canvas{display:block;margin:auto;background:#020617;border-radius:16px}

/* HUD */
.hud{
  position:absolute;top:12px;width:100%;
  display:flex;justify-content:center;gap:14px;z-index:5;
  font-family:'Orbitron',sans-serif;
}
.hud span{
  padding:8px 18px;
  border-radius:999px;
  font-size:13px;
  background:linear-gradient(135deg,#020617,#020617);
  box-shadow:0 0 14px rgba(56,189,248,.7);
  animation:hudGlow 2s infinite;
}
@keyframes hudGlow{
  0%,100%{box-shadow:0 0 8px rgba(56,189,248,.4)}
  50%{box-shadow:0 0 20px rgba(56,189,248,1)}
}
.bump{animation:bump .2s}
@keyframes bump{from{transform:scale(1)}to{transform:scale(1.2)}}

/* BOSS BAR */
#bossBar{
  position:absolute;top:55px;left:50%;transform:translateX(-50%);
  width:220px;height:10px;border-radius:999px;
  background:#1f2933;overflow:hidden;display:none;
}
#bossLife{
  height:100%;background:#ef4444;width:100%;
}

/* OVERLAY / MENU */
.overlay{
  position:absolute;inset:0;display:none;
  align-items:center;justify-content:center;
  background:rgba(0,0,0,.85);z-index:10;
}
.menu{
  width:320px;padding:26px;border-radius:22px;
  background:linear-gradient(180deg,#020617,#020617);
  box-shadow:0 0 50px rgba(56,189,248,.6);
  animation:menuIn .4s ease;
  text-align:center;
}
@keyframes menuIn{
  from{transform:translateY(40px) scale(.9);opacity:0}
  to{transform:translateY(0) scale(1);opacity:1}
}
.menu h2{
  color:#38bdf8;
  margin-bottom:10px;
  font-family:'Orbitron',sans-serif;
}
.menu button{
  width:100%;margin:6px 0;padding:12px;
  border:none;border-radius:999px;
  font-weight:bold;cursor:pointer;
  background:#38bdf8;color:#020617;
  transition:.2s;
}
.menu button:hover{
  transform:scale(1.06);
  box-shadow:0 0 14px #38bdf8;
}

/* INTRO */
#intro{
  position:absolute;inset:0;background:#020617;
  display:flex;align-items:center;justify-content:center;
  flex-direction:column;z-index:20;transition:.6s;
}
#rocket{
  width:40px;height:60px;background:#38bdf8;
  clip-path:polygon(50% 0,100% 100%,50% 85%,0 100%);
  animation:fly 1.2s infinite;
}
@keyframes fly{
  0%{transform:translateY(20px)}
  50%{transform:translateY(-30px)}
  100%{transform:translateY(20px)}
}

/* MOBILE CONTROLS */
#shootBtn,#pauseBtn{
  position:absolute;width:80px;height:80px;
  border-radius:50%;border:none;z-index:6;
  display:none;font-weight:bold;
}
#shootBtn{right:20px;bottom:20px;background:#ef4444;color:#fff}
#pauseBtn{left:20px;top:20px;background:#38bdf8;color:#000}

/* JOYSTICK */
#joystick{
  position:absolute;bottom:20px;left:20px;
  width:120px;height:120px;border-radius:50%;
  background:rgba(255,255,255,.1);
  display:none;z-index:6;touch-action:none;
}
#stick{
  width:50px;height:50px;border-radius:50%;
  background:#38bdf8;
  position:absolute;left:35px;top:35px;
}
</style>
</head>

<body>

<div id="intro">
  <div id="rocket"></div>
  <h1 style="color:#38bdf8">SPACE SURVIVOR</h1>
  <p>Toque para começar</p>
</div>

<div class="hud" id="hud">
  <span id="hudScore">Score: 0</span>
  <span id="hudCoins">Moedas: 0</span>
</div>

<div id="bossBar"><div id="bossLife"></div></div>

<div id="overlay" class="overlay"></div>
<canvas id="game" width="400" height="600"></canvas>

<button id="shootBtn">ATIRAR</button>
<button id="pauseBtn">PAUSE</button>
<div id="joystick"><div id="stick"></div></div>

<script>
/* ===== UTIL ===== */
const isMobile=/Android|iPhone/i.test(navigator.userAgent);
const vibrate=t=>{if(isMobile&&navigator.vibrate)navigator.vibrate(t)};

/* ===== SAVE ===== */
const save=JSON.parse(localStorage.getItem("spaceSave")||"{}");
save.coins??=0;
save.options??={hud:true,vibration:true};
localStorage.setItem("spaceSave",JSON.stringify(save));

/* ===== STATE ===== */
let playing=false,paused=false;

/* ===== CANVAS ===== */
const canvas=document.getElementById("game");
const ctx=canvas.getContext("2d");

/* ===== OBJECTS ===== */
let stars=[...Array(120)].map(()=>({x:Math.random()*400,y:Math.random()*600,s:Math.random()*2+1}));
const player={x:200,y:500,r:14,speed:4};
let bullets=[],enemies=[];
let boss=null;
let score=0,coins=save.coins,cooldown=0;

/* ===== INPUT ===== */
const input={x:0,y:0,shoot:false};

/* ===== INTRO ===== */
intro.onclick=()=>{
vibrate(40);
intro.style.opacity=0;
setTimeout(()=>intro.remove(),600);
menu();
};

/* ===== MENUS ===== */
const overlay=document.getElementById("overlay");
function showMenu(h){overlay.innerHTML=h;overlay.style.display="flex"}
function hideMenu(){overlay.style.display="none"}

function menu(){
showMenu(`
<div class="menu">
<h2>SPACE SURVIVOR</h2>
<button onclick="start()">JOGAR</button>
<button onclick="options()">OPÇÕES</button>
<button onclick="credits()">CRÉDITOS</button>
</div>`);
}

function options(){
showMenu(`
<div class="menu">
<h2>OPÇÕES</h2>
<button onclick="toggleHUD()">HUD: ${save.options.hud?'ON':'OFF'}</button>
<button onclick="toggleVibration()">VIBRAÇÃO: ${save.options.vibration?'ON':'OFF'}</button>
<button onclick="menu()">VOLTAR</button>
</div>`);
}

function credits(){
showMenu(`
<div class="menu">
<h2>CRÉDITOS</h2>
<p>Game by Ander</p>
<p>Thanks: You ❤️</p>
<button onclick="menu()">VOLTAR</button>
</div>`);
}

/* ===== OPTIONS ===== */
function toggleHUD(){
save.options.hud=!save.options.hud;
hud.style.display=save.options.hud?'flex':'none';
localStorage.setItem("spaceSave",JSON.stringify(save));
options();
}
function toggleVibration(){
save.options.vibration=!save.options.vibration;
localStorage.setItem("spaceSave",JSON.stringify(save));
options();
}

/* ===== START / PAUSE ===== */
function start(){
playing=true;paused=false;
hideMenu();
shootBtn.style.display=pauseBtn.style.display=joystick.style.display="block";
}
pauseBtn.onclick=()=>{
paused=!paused;
if(paused){
showMenu(`<div class="menu"><h2>PAUSE</h2><button onclick="paused=false;hideMenu()">CONTINUAR</button><button onclick="menu()">SAIR</button></div>`);
}else hideMenu();
};

/* ===== JOYSTICK ===== */
let joy=false;
joystick.addEventListener("touchstart",()=>joy=true);
joystick.addEventListener("touchmove",e=>{
if(!joy)return;
const r=joystick.getBoundingClientRect();
const t=e.touches[0];
const dx=t.clientX-(r.left+r.width/2);
const dy=t.clientY-(r.top+r.height/2);
const d=Math.min(30,Math.hypot(dx,dy));
const a=Math.atan2(dy,dx);
stick.style.left=35+Math.cos(a)*d+"px";
stick.style.top=35+Math.sin(a)*d+"px";
input.x=Math.cos(a)*(d/30);
input.y=Math.sin(a)*(d/30);
});
joystick.addEventListener("touchend",()=>{
joy=false;stick.style.left="35px";stick.style.top="35px";
input.x=input.y=0;
});

/* ===== SHOOT ===== */
shootBtn.ontouchstart=()=>{input.shoot=true;vibrate(10)}
shootBtn.ontouchend=()=>input.shoot=false;

/* ===== GAME LOOP ===== */
function update(){
if(!playing||paused)return;

player.x+=input.x*player.speed;
player.y+=input.y*player.speed;
player.x=Math.max(20,Math.min(380,player.x));
player.y=Math.max(20,Math.min(580,player.y));

if(input.shoot&&cooldown<=0){
cooldown=12;
bullets.push({x:player.x,y:player.y});
}
cooldown--;

if(!boss&&score>0&&score%200===0){
boss={x:200,y:-80,r:40,hp:200,max:200};
bossBar.style.display="block";
}

if(!boss&&Math.random()<0.03)
enemies.push({x:Math.random()*360+20,y:-20,r:14});

bullets.forEach(b=>b.y-=8);
enemies.forEach(e=>e.y+=2);

enemies=enemies.filter(e=>{
if(bullets.some(b=>Math.hypot(e.x-b.x,e.y-b.y)<e.r)){
score+=10;coins++;return false;
}
return e.y<620;
});

if(boss){
boss.y+=1;
bullets.forEach(b=>{
if(Math.hypot(boss.x-b.x,boss.y-b.y)<boss.r){
boss.hp-=5;
}
});
bossLife.style.width=(boss.hp/boss.max*100)+"%";
if(boss.hp<=0){
boss=null;
bossBar.style.display="none";
score+=200;
}
}

hudScore.textContent="Score: "+score;
hudCoins.textContent="Moedas: "+coins;
}

function draw(){
ctx.clearRect(0,0,400,600);
ctx.fillStyle="#888";
stars.forEach(s=>{s.y+=s.s*.3;if(s.y>600)s.y=0;ctx.fillRect(s.x,s.y,2,2)});
ctx.fillStyle="#38bdf8";
ctx.beginPath();ctx.arc(player.x,player.y,player.r,0,7);ctx.fill();
ctx.fillStyle="#fff";
bullets.forEach(b=>ctx.fillRect(b.x-2,b.y,4,10));
ctx.fillStyle="#ef4444";
enemies.forEach(e=>{ctx.beginPath();ctx.arc(e.x,e.y,e.r,0,7);ctx.fill()});
if(boss){
ctx.strokeStyle="#ef4444";
ctx.beginPath();ctx.arc(boss.x,boss.y,boss.r,0,7);ctx.stroke();
}
}

(function loop(){update();draw();requestAnimationFrame(loop)})();
</script>
</body>
</html>